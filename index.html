<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Baby & Family Care — Cash on Delivery</title>
  <meta name="description" content="Premium baby & family care products. Order on the same page. Cash on Delivery nationwide." />
  <link rel="icon" href="data:," />

  <!-- Tailwind (CDN) for rapid testing) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Meta Pixel (optional) — replace YOUR_PIXEL_ID -->
  <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', 'YOUR_PIXEL_ID');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1"/></noscript>

  <style>
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  </style>
</head>
<body class="bg-white text-gray-900">
  <!-- Promo / trust bar -->
  <div class="bg-emerald-600 text-white text-sm">
    <div class="mx-auto max-w-7xl px-4 py-2 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1">
      <p class="font-medium">সারা দেশে হোম ডেলিভারি • অগ্রিম লাগবে না • হাতে পেয়ে চেক করে টাকা দিবেন</p>
      <p class="opacity-90">ঢাকা ১–৩ দিন • ঢাকার বাইরে ৩–৫ দিন</p>
    </div>
  </div>

  <!-- Header -->
  <header class="sticky top-0 z-30 bg-white/90 backdrop-blur border-b">
    <div class="mx-auto max-w-7xl px-4 py-3 flex items-center justify-between">
      <a href="#" class="text-lg font-extrabold tracking-tight">Baby<span class="text-emerald-600">Care</span></a>
      <span class="text-sm text-gray-500">Cash on Delivery</span>
    </div>
  </header>

  <!-- Main content: left = customer details; right = products + summary -->
  <main class="mx-auto max-w-7xl px-4 py-8 grid md:grid-cols-2 gap-8">
    <!-- Customer Details -->
    <section class="rounded-2xl border p-6">
      <h2 class="text-xl font-bold">Your details</h2>
      <p class="text-sm text-gray-600 mt-1">We deliver nationwide. Payment after receiving (COD).</p>
      <form id="detailsForm" class="mt-4 space-y-4" autocomplete="on">
        <div>
          <label class="block text-sm font-medium">First name</label>
          <input required name="firstName" id="firstName" class="mt-1 w-full rounded-xl border px-3 py-2" placeholder="Your first name" />
        </div>
        <div>
          <label class="block text-sm font-medium">Mobile number</label>
          <input required name="phone" id="phone" pattern="01[0-9]{9}" class="mt-1 w-full rounded-xl border px-3 py-2" placeholder="01XXXXXXXXX" />
          <p class="mt-1 text-xs text-gray-500">11‑digit Bangladesh number (starts with 01)</p>
        </div>
        <div>
          <label class="block text-sm font-medium">Address</label>
          <textarea required name="address" id="address" rows="3" class="mt-1 w-full rounded-xl border px-3 py-2" placeholder="House, road, area, district"></textarea>
        </div>
      </form>
    </section>

    <!-- Products + Summary -->
    <section class="space-y-6">
      <!-- Products list -->
      <div class="rounded-2xl border p-6">
        <h2 class="text-xl font-bold">Select products</h2>
        <div id="productGrid" class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
      </div>

      <!-- Order Summary -->
      <div class="rounded-2xl border p-6">
        <div class="flex items-center justify-between">
          <h2 class="text-xl font-bold">Order summary</h2>
          <button id="clearBtn" class="text-sm text-gray-600 hover:text-red-600">Clear</button>
        </div>
        <div id="summaryLines" class="mt-3 space-y-2 text-sm"></div>
        <div class="mt-4 flex items-center justify-between text-base font-semibold">
          <span>Total</span>
          <span id="totalBDT">৳0</span>
        </div>
        <button id="placeOrder" class="mt-4 w-full rounded-xl bg-emerald-600 text-white px-5 py-3 font-semibold hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Place order (COD)</button>
        <p class="mt-2 text-xs text-gray-500">By placing an order you agree to our policies. We do not sell prescription drugs.</p>
        <p id="status" class="mt-3 text-sm"></p>
      </div>
    </section>
  </main>

  <footer class="mx-auto max-w-7xl px-4 py-12 text-xs text-gray-500">
    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2">
      <p>© <span id="year"></span> BabyCare. All rights reserved.</p>
      <div class="flex gap-3">
        <a href="#" class="hover:underline">Return Policy</a>
        <a href="#" class="hover:underline">Shipping</a>
        <a href="#" class="hover:underline">Disclaimer</a>
      </div>
    </div>
  </footer>

  <script>
    // ---- CONFIG ----
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxwR5N9d4_Kr-M7yw3gCc0htQ6sydwElvaE2-8bdWZn1LT2NWydpvMCUAZVZtdKmZv0/exec'; // replace after you deploy Apps Script (see instructions below)

    const products = [
      {id:'p1', name:'BabyCare Cough Syrup (100ml)', price:499, img:'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?q=80&w=1200&auto=format&fit=crop'},
      {id:'p2', name:'PainEase Tablets (10s)', price:249, img:'https://images.unsplash.com/photo-1596204976871-9a5100c4e3fb?q=80&w=1200&auto=format&fit=crop'},
      {id:'p3', name:'VitaKids Multi Syrup (200ml)', price:699, img:'https://images.unsplash.com/photo-1512303387766-6ef70f502c09?q=80&w=1200&auto=format&fit=crop'},
      {id:'p4', name:'Baby Lotion (200ml)', price:399, img:'https://images.unsplash.com/photo-1556228453-efd1b8f9a15e?q=80&w=1200&auto=format&fit=crop'}
    ];

    const fmtBDT = new Intl.NumberFormat('bn-BD');
    const $ = (s)=>document.querySelector(s);
    const $$ = (s)=>document.querySelectorAll(s);

    function renderProducts(){
      const grid = $('#productGrid');
      grid.innerHTML = products.map(p=>`
        <article class="rounded-2xl border p-4 flex gap-3">
          <img class="w-24 h-24 object-cover rounded-xl" src="${p.img}" alt="${p.name}" />
          <div class="flex-1">
            <h3 class="font-semibold line-clamp-2">${p.name}</h3>
            <p class="mt-1 font-bold">৳${p.price}</p>
            <div class="mt-2 inline-flex items-center gap-2">
              <label class="text-sm">Qty</label>
              <button data-id="${p.id}" class="dec rounded border px-2">-</button>
              <input data-id="${p.id}" class="qty w-14 rounded border px-2 py-1 text-center" type="number" min="0" value="0" />
              <button data-id="${p.id}" class="inc rounded border px-2">+</button>
            </div>
          </div>
        </article>`).join('');

      $$('.inc').forEach(b=>b.addEventListener('click', e=> changeQty(e.currentTarget.dataset.id, +1)));
      $$('.dec').forEach(b=>b.addEventListener('click', e=> changeQty(e.currentTarget.dataset.id, -1)));
      $$('.qty').forEach(i=>i.addEventListener('input', e=> setQty(e.currentTarget.dataset.id, parseInt(e.currentTarget.value||'0',10))));
    }

    const state = { qtys: Object.fromEntries(products.map(p=>[p.id,0])) };

    function setQty(id, n){
      const prev = state.qtys[id]||0;
      state.qtys[id] = Math.max(0, n|0);
      if(prev===0 && state.qtys[id]>0){ try{ fbq('track','AddToCart',{content_ids:[id], value:productById(id).price, currency:'BDT'});}catch(_){}}
      syncInputs();
      renderSummary();
    }

    function changeQty(id, delta){ setQty(id, (state.qtys[id]||0)+delta); }

    function productById(id){ return products.find(p=>p.id===id); }

    function selectedLines(){
      return Object.entries(state.qtys)
        .filter(([,q])=>q>0)
        .map(([id,q])=>{ const p=productById(id); return {id, name:p.name, price:p.price, qty:q, line:p.price*q}; });
    }

    function orderTotal(){ return selectedLines().reduce((s,x)=>s+x.line,0); }

    function syncInputs(){
      $$('.qty').forEach(i=>{ const id=i.dataset.id; i.value = state.qtys[id]||0; });
    }

    function renderSummary(){
      const wrap = $('#summaryLines');
      const lines = selectedLines();
      if(!lines.length){ wrap.innerHTML = '<p class="text-gray-600">No items selected yet.</p>'; $('#totalBDT').textContent='৳0'; updateButtonState(); return; }
      wrap.innerHTML = lines.map(l=>`
        <div class="flex items-center justify-between"><span>${l.name} × ${l.qty}</span><span>৳${l.line}</span></div>`).join('');
      $('#totalBDT').textContent = '৳'+orderTotal();
      updateButtonState();
    }

    function detailsValid(){
      const f=$('#firstName'), p=$('#phone'), a=$('#address');
      return f.value.trim().length>0 && /^01\d{9}$/.test(p.value.trim()) && a.value.trim().length>0;
    }

    function updateButtonState(){
      $('#placeOrder').disabled = !(detailsValid() && selectedLines().length>0);
    }

    // Track InitiateCheckout on first interaction with details form
    let initiated=false; ['firstName','phone','address'].forEach(id=>{
      document.addEventListener('focusin', (e)=>{
        if(e.target && e.target.id===id && !initiated){ initiated=true; try{ fbq('track','InitiateCheckout'); }catch(_){}}
      });
    });

    // Place order
    async function submitOrder(){
      const order = {
        firstName: $('#firstName').value.trim(),
        phone: $('#phone').value.trim(),
        address: $('#address').value.trim(),
        items: selectedLines(),
        total: orderTotal(),
        createdAt: new Date().toISOString()
      };

      // Frontend validation
      if(order.items.length===0){ $('#status').textContent='Please select at least one product.'; return; }
      if(!detailsValid()){ $('#status').textContent='Please fill your name, valid mobile number and address.'; return; }

      $('#status').textContent='Placing order…';
      $('#placeOrder').disabled = true;

      try{
        // Use x-www-form-urlencoded to avoid CORS preflight complications with Apps Script
        const body = new URLSearchParams({ data: JSON.stringify(order) });
        const res = await fetch(WEB_APP_URL, { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body });
        // We won't rely on the response body (Apps Script may not set CORS headers)
        try{ fbq('track','Purchase',{value:order.total, currency:'BDT', contents: order.items.map(i=>({id:i.id, quantity:i.qty}))}); }catch(_){ }
        $('#status').textContent='✅ Order placed! We will call you shortly.';
        // Reset selections
        Object.keys(state.qtys).forEach(k=>state.qtys[k]=0); syncInputs(); renderSummary();
        document.getElementById('detailsForm').reset();
      } catch(err){
        console.error(err);
        $('#status').textContent='❌ Could not place order. Please try again or contact us.';
      } finally {
        updateButtonState();
      }
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('year').textContent = new Date().getFullYear();
      renderProducts(); renderSummary();
      // Re-validate button on details change
      ['firstName','phone','address'].forEach(id=> document.getElementById(id).addEventListener('input', updateButtonState));
      document.getElementById('clearBtn').addEventListener('click', ()=>{ Object.keys(state.qtys).forEach(k=>state.qtys[k]=0); syncInputs(); renderSummary(); });
      document.getElementById('placeOrder').addEventListener('click', submitOrder);
    });
  </script>

  <!--
  ==========================
  HOW TO SAVE ORDERS (Google Sheets via Apps Script)
  ==========================
  1) Create a Google Sheet named "Orders". Keep a sheet/tab named "Orders".
  2) Extensions → Apps Script → paste the Code.gs from the instructions I sent in chat.
  3) In that script, put your Sheet ID (from the sheet URL).
  4) Deploy → "New deployment" → Type: Web app → Execute as: Me → Who has access: Anyone → Deploy.
  5) Copy the Web app URL and replace WEB_APP_URL above.
  6) Publish your site and test an order. Check the sheet for new rows.
  -->
</body>
</html>
